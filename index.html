<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RFP ROI Calculator & Success Plan</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    label { display: block; margin-top: 16px; font-weight: bold; }
    input, textarea, select { width: 100%; padding: 8px; margin-top: 4px; }
    .helper { font-size: 13px; color: #666; margin-bottom: 8px; }
    button { margin-top: 20px; padding: 10px 20px; font-size: 16px; margin-right: 10px; }
    .result, .success-plan { margin-top: 24px; font-size: 16px; background: #f7f7f7; padding: 20px; border-radius: 8px; display: none; }
    .result strong, .success-plan strong { font-size: 18px; }
    canvas { margin-top: 30px; }
    #emailSummaryWrapper { margin-top: 24px; display: none; }
    #emailSummary { width: 100%; height: 300px; font-family: monospace; padding: 12px; }
  </style>
</head>
<body>

<h2>RFP ROI Calculator</h2>

<!-- Input Fields -->
<label>RFPs per month</label>
<input type="number" id="rfpsPerMonth">

<label>Win rate (%)</label>
<input type="number" id="winRate">

<label>Average deal size ($)</label>
<input type="number" id="dealSize">

<label>Hours to complete one RFP</label>
<input type="number" id="hoursPerRFP">

<label>Team members per RFP</label>
<input type="number" id="teamSize">

<label>Avg hourly cost ($)</label>
<input type="number" id="hourlyCost">

<label>Reusable content (%)</label>
<input type="number" id="reusePercent">

<label>Time saved per RFP (hrs)</label>
<input type="number" id="timeSavingsPerRFP">

<label>Missed RFPs per month</label>
<input type="number" id="missedRFPs">

<label>Days until decision</label>
<input type="number" id="daysUntilDecision">

<!-- Buttons -->
<button onclick="calculateROI()">Calculate</button>
<button onclick="loadDefaults()">Use Conservative Defaults</button>

<!-- Results -->
<div class="result" id="result"></div>
<canvas id="lossChart" width="600" height="300"></canvas>
<button onclick="document.querySelector('.success-plan').style.display='block'">Create Success Plan</button>

<!-- Success Plan Builder -->
<div class="success-plan">
  <h3>Mutual Success Plan</h3>
  <label>Decision Maker</label>
  <input id="decisionMaker" placeholder="Name – Role">

  <label>Champion</label>
  <input id="champion" placeholder="Name – Role">

  <label>Security Contact</label>
  <input id="securityContact" placeholder="Name – Role">

  <label>Legal Contact</label>
  <input id="legalContact" placeholder="Name – Role">

  <label>Additional Influencers</label>
  <textarea id="influencers"></textarea>

  <label>Risks or Roadblocks</label>
  <textarea id="risks"></textarea>

  <label>Second Demo Date</label>
  <input type="date" id="demoDate">

  <label>Security Review Date</label>
  <input type="date" id="securityDate">

  <label>Legal Review Date</label>
  <input type="date" id="legalDate">

  <label>Decision Date</label>
  <input type="date" id="decisionDate">

  <button onclick="generateSuccessPlan()">Generate Success Plan</button>
  <button onclick="generateEmailSummary()">Generate Email Summary</button>
  <a id="downloadLink" style="display:none; margin-left:10px;" download="ROI_Summary.html">Download HTML Summary</a>

  <div id="planSummary"></div>
</div>


<!-- Email Summary Output -->
<div id="emailSummaryWrapper">
  <h3>Email-Friendly Summary</h3>
  <textarea id="emailSummary"></textarea>
</div>

<script>
let chartInstance;
let globalDailyLoss = 0;
let globalProjectedLoss = 0;
let successPlanText = '';

function loadDefaults() {
  document.getElementById('rfpsPerMonth').value = 4;
  document.getElementById('winRate').value = 20;
  document.getElementById('dealSize').value = 50000;
  document.getElementById('hoursPerRFP').value = 30;
  document.getElementById('teamSize').value = 3;
  document.getElementById('hourlyCost').value = 85;
  document.getElementById('reusePercent').value = 30;
  document.getElementById('timeSavingsPerRFP').value = 10;
  document.getElementById('missedRFPs').value = 1;
  document.getElementById('daysUntilDecision').value = 14;
}

function calculateROI() {
  const rfpsPerMonth = +document.getElementById('rfpsPerMonth').value;
  const winRate = +document.getElementById('winRate').value / 100;
  const dealSize = +document.getElementById('dealSize').value;
  const hoursPerRFP = +document.getElementById('hoursPerRFP').value;
  const teamSize = +document.getElementById('teamSize').value;
  const hourlyCost = +document.getElementById('hourlyCost').value;
  const reusePercent = +document.getElementById('reusePercent').value / 100;
  const timeSavingsPerRFP = +document.getElementById('timeSavingsPerRFP').value;
  const missedRFPs = +document.getElementById('missedRFPs').value;
  const daysUntilDecision = +document.getElementById('daysUntilDecision').value;

  const laborSavings = timeSavingsPerRFP * teamSize * hourlyCost * rfpsPerMonth;
  const lostRevenue = missedRFPs * winRate * dealSize;
  const totalMonthlyLoss = laborSavings + lostRevenue;
  const dailyLoss = totalMonthlyLoss / 30;
  const projectedLoss = dailyLoss * daysUntilDecision;

  globalDailyLoss = dailyLoss;
  globalProjectedLoss = projectedLoss;

  document.querySelector('.result').style.display = 'block';
  document.getElementById('result').innerHTML = `
    <strong>Results Summary:</strong><br><br>
    <strong>Estimated Daily Cost of Inaction:</strong> $${dailyLoss.toFixed(2)}<br>
    <strong>Projected Revenue Lost by Decision Date:</strong> $${projectedLoss.toFixed(2)}<br><br>
    <u>Calculation Breakdown:</u><br>
    <strong>1. Labor Savings:</strong><br>
    = ${timeSavingsPerRFP} hrs × ${teamSize} people × $${hourlyCost}/hr × ${rfpsPerMonth} RFPs<br>
    = <strong>$${laborSavings.toFixed(2)}</strong><br><br>
    <strong>2. Missed Revenue:</strong><br>
    = ${missedRFPs} × ${(winRate * 100).toFixed(1)}% win rate × $${dealSize}<br>
    = <strong>$${lostRevenue.toFixed(2)}</strong><br><br>
    <strong>3. Total Monthly Loss:</strong> $${totalMonthlyLoss.toFixed(2)}<br>
    <strong>4. Daily Loss:</strong> $${dailyLoss.toFixed(2)}<br>
    <strong>5. Projected Loss over ${daysUntilDecision} days:</strong> $${projectedLoss.toFixed(2)}<br>
  `;

  const ctx = document.getElementById('lossChart').getContext('2d');
  if (chartInstance) chartInstance.destroy();
  chartInstance = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Labor Savings', 'Missed Revenue', 'Projected Loss'],
      datasets: [{
        label: 'Loss ($)',
        data: [laborSavings, lostRevenue, projectedLoss],
        backgroundColor: ['#f39c12', '#e74c3c', '#9b59b6']
      }]
    },
    options: { scales: { y: { beginAtZero: true } } }
  });
}

function generateSuccessPlan() {
  const decisionMaker = document.getElementById('decisionMaker').value || 'Not provided';
  const champion = document.getElementById('champion').value || 'Not provided';
  const securityContact = document.getElementById('securityContact').value || 'Not provided';
  const legalContact = document.getElementById('legalContact').value || 'Not provided';
  const influencers = document.getElementById('influencers').value || 'None provided';
  const risks = document.getElementById('risks').value || 'None provided';
  const demoDate = document.getElementById('demoDate').value || 'Not set';
  const securityDate = document.getElementById('securityDate').value || 'Not set';
  const legalDate = document.getElementById('legalDate').value || 'Not set';
  const decisionDate = document.getElementById('decisionDate').value || 'Not set';

  const dailyLossFormatted = globalDailyLoss ? `$${globalDailyLoss.toFixed(2)}` : 'N/A';
  const projectedLossFormatted = globalProjectedLoss ? `$${globalProjectedLoss.toFixed(2)}` : 'N/A';

  const successPlanHTML = `
    <div style="font-family: Arial, sans-serif; line-height: 1.5; color: #333;">
      <h2 style="font-weight: 700; border-bottom: 2px solid #000; padding-bottom: 8px; margin-bottom: 16px;">Mutual Success Plan Summary</h2>

      <section style="margin-bottom: 20px;">
        <h3 style="font-weight: 600; margin-bottom: 6px;">Cost of Inaction</h3>
        <p>Estimated daily loss related to RFP inefficiency: <strong>${dailyLossFormatted} / day</strong></p>
        <p>Projected total loss by decision day: <strong>${projectedLossFormatted}</strong></p>
      </section>

      <section style="margin-bottom: 20px;">
        <h3 style="font-weight: 600; margin-bottom: 6px;">Key Stakeholders</h3>
        <ul style="list-style-type: disc; padding-left: 20px;">
          <li><strong>Decision Maker:</strong> ${decisionMaker}</li>
          <li><strong>Champion:</strong> ${champion}</li>
          <li><strong>Security Contact:</strong> ${securityContact}</li>
          <li><strong>Legal Contact:</strong> ${legalContact}</li>
          ${influencers.trim() !== '' ? `<li><strong>Additional Influencers:</strong> ${influencers}</li>` : ''}
        </ul>
      </section>

      <section style="margin-bottom: 20px;">
        <h3 style="font-weight: 600; margin-bottom: 6px;">Milestones & Timeline</h3>
        <ul style="list-style-type: none; padding-left: 0;">
          <li><strong>Second Demo:</strong> ${demoDate}</li>
          <li><strong>Security Review:</strong> ${securityDate}</li>
          <li><strong>Legal Review:</strong> ${legalDate}</li>
          <li><strong>Target Decision Date:</strong> ${decisionDate}</li>
        </ul>
      </section>

      <section style="margin-bottom: 20px;">
        <h3 style="font-weight: 600; margin-bottom: 6px;">Risks or Roadblocks</h3>
        <p>${risks}</p>
      </section>
    </div>
  `;

  document.getElementById('planSummary').innerHTML = successPlanHTML;
}



function generateEmailSummary() {
  const summary = document.getElementById('result').innerText + '\n' + successPlanText;
  document.getElementById('emailSummaryWrapper').style.display = 'block';
  document.getElementById('emailSummary').value = summary;

  const blob = new Blob([summary], { type: 'text/html' });
  const url = URL.createObjectURL(blob);
  const link = document.getElementById('downloadLink');
  link.href = url;
  link.style.display = 'inline';
}
</script>
</body>
</html>
